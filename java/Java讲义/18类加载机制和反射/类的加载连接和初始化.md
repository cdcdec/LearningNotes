# JVM和类
当某个java程序运行时,会启动一个Java虚拟机进程,java程序的所有线程,变量都使用该JVM进程的内存区,当系统出现以下几种情况时,JVM进程将被终止:
* 程序运行到最后得到正常结果;
* 程序运行到使用System.exit()或Runtime.getRuntime().exit()代码处结束程序;
* 程序执行过程中遇到未捕获的异常或错误而结束;
* 程序所在平台强制结束了JVM进程.
JVM进程结束后,该进程在内存中的状态会丢失。

## 类的加载
类加载指的是将类的class文件读入内存中,并为之创建一个java.lang.Class对象.类的加载器由类加载器完成.类加载器通常由JVM提供(系统加载器),也可以由开发者通过继承ClassLoader基类创建。通过不同的类加载器,可以从不同来源加载类的二进制数据,通常有如下几种来源:
* 从本地文件系统加载class文件;
* 从JAR包加载class文件;
* 通过网络加载class文件;
* 把一个java源文件动态编译,并执行加载.

## 类的连接
类的连接阶段负责把类的二进制数据合并到JRE中:
* 验证:检验被加载的类是否有正确的内部结构,并和其它类协调一致;
* 准备:负责为类的静态Field分配内存,并设置默认初始值;
* 解析:将类的二进制数据中的符号引用替换位直接引用。

## 类的初始化
虚拟机负责对类进行初始化,主要是对静态Field进行初始化。静态变量和静态代码块都会被当作类的初始化语句,JVM按照它们在程序中个人循序依次执行他们.初始化步骤有如下几个:
* 假设这个类没有被加载和连接,则程序先加载并连接该类;
* 假如该类的直接父类还没有被初始化,则先初始化其直接父类(对直接父类的初始化,也遵循此1-3步);
* 假如这个类中有初始化语句,则初始化这些语句。
## 类初始化的时机
* 创建类的实例,通过new操作符,通过反射或者通过反序列化的方式
* 调用某个类的静态方法;
* 访问某个类或接口的静态Field,或者为该静态Field赋值;
* 使用反射方式来强制创建某个类或接口对应的java.lang.Class对象;
>ClassLoader类的loadClass()方法加载某个类时,只是加载类,不会进行类初始化,Class.forName("")时才会进行类初始化.
* 初始化某个类的子类;
* 直接使用java.exe命令来运行某个主类;
>特殊情况,Field型的静态变量,且其值在编译期就能确定,JAVA编译器会在编译期直接把这个Field出现的地方替换成它的值,这个Field相当于"宏变量" 此时不会进行类初始化。
